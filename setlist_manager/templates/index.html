{% extends "base.html" %}

{% block title %}Setlists · Setlist Manager{% endblock %}

{% block content %}
<section class="panel">
    <header>
        <h2>Your Setlists</h2>
        <div class="panel-actions">
            <a class="button" href="{{ url_for('setlists.create_setlist') }}">Create Setlist</a>
            <a class="button" href="{{ url_for('setlists.import_setlists') }}">Import Past Setlists</a>
        </div>
    </header>

    {% if setlists %}
        <div data-sortable-table>
            <table class="data-table">
                <thead>
                    <tr>
                        <th data-sortable="text">Name</th>
                        <th data-sortable="date">Show Date</th>
                        <th data-sortable="number">Songs</th>
                        <th data-sortable="duration">Total Duration</th>
                        <th data-sortable="duration">Target Duration</th>
                        <th data-sortable="date">Created</th>
                        <th>Actions</th>
                    </tr>
                </thead>
            <tbody>
                {% for setlist in setlists %}
                    <tr>
                        <td>
                            <a href="{{ url_for('setlists.view_setlist', setlist_id=setlist.id) }}" class="setlist-link">
                                <strong>{{ setlist.name }}</strong>
                            </a>
                            {% if setlist.description %}
                                <br><small class="setlist-description">{{ setlist.description }}</small>
                            {% endif %}
                        </td>
                        <td>
                            {% if setlist.show_date %}
                                {{ setlist.show_date.strftime('%b %d, %Y') }}
                            {% else %}
                                —
                            {% endif %}
                        </td>
                        <td>{{ setlist.cached_song_count_value }}</td>
                        <td>{{ setlist.cached_total_duration_label }}</td>
                        <td>{{ setlist.target_duration_label }}</td>
                        <td>{{ setlist.created_at.strftime('%b %d, %Y') }}</td>
                        <td>
                            <a class="button" href="{{ url_for('setlists.view_setlist', setlist_id=setlist.id) }}">Open</a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
        <p>No setlists yet — <a href="{{ url_for('setlists.create_setlist') }}">create your first one</a>.</p>
    {% endif %}
</section>

<section class="panel secondary">
    <header>
        <h2>Library Snapshot</h2>
    </header>
    <p>You currently have {{ total_songs }} song{{ '' if total_songs == 1 else 's' }} saved.</p>
    <p><a href="{{ url_for('setlists.songs') }}">Manage songs</a></p>
</section>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='sortable-table.js') }}" defer></script>
{% endblock %}
